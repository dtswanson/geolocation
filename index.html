<!DOCTYPE html>
<html>
<head>
  <title>Mr. Swanson's HTML Geolocation</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <style>
    #map {
      height: 400px;
      width: 100%;
      display: none; /* Initially hide the map */
    }
  </style>
</head>
<body class="bg-light">
  <div class="container mt-5">
    <div class="text-center">
      <h1 class="animate__animated animate__fadeInDown">Mr. Swanson's HTML Geolocation</h1>
      <p class="animate__animated animate__fadeInUp">Click the button to get your coordinates and display them on the map.</p>
      <button id="geoButton" class="btn btn-primary animate__animated animate__pulse">Find me!</button>
      <p id="demo" class="mt-3 animate__animated"></p>
    </div>
    <div id="map" class="animate__animated mt-4"></div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    const x = $("#demo");
    let map;

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition, showError);
      } else {
        x.html("Geolocation is not supported by this browser.");
      }
    }

    function showPosition(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      x.html("Latitude: " + lat + "<br>Longitude: " + lon);

      if (!map) {
        map = L.map('map').setView([lat, lon], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
      } else {
        map.setView([lat, lon], 13);
      }

      L.marker([lat, lon]).addTo(map)
        .bindPopup("You are here.")
        .openPopup();

      // Show the map with animation
      $("#map").fadeIn().addClass("animate__fadeIn");
    }

    function showError(error) {
      switch(error.code) {
        case error.PERMISSION_DENIED:
          x.html("User denied the request for Geolocation.");
          break;
        case error.POSITION_UNAVAILABLE:
          x.html("Location information is unavailable.");
          break;
        case error.TIMEOUT:
          x.html("The request to get user location timed out.");
          break;
        case error.UNKNOWN_ERROR:
          x.html("An unknown error occurred.");
          break;
      }
    }

    $(document).ready(function() {
      $("#geoButton").click(function() {
        $(this).addClass("animate__bounceOut");
        getLocation();
      });
    });
  </script>
</body>
</html>
